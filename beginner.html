<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Beginner &mdash; SWAP-IT Demonstration Scenario 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=8d563738"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Intermediate" href="intermediate.html" />
    <link rel="prev" title="Tutorials" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            SWAP-IT Demonstration Scenario
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Demonstration Scenario Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="swpa_it_sw.html">SWAP-IT Software Modules</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="getting_started.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="requ.html">Requirements and Installation</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="tutorial.html">Tutorials</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Beginner</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#beginner-writing-custom-pfdl-files">Beginner: Writing custom PFDL files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#beginner-building-resource-specific-information-models">Beginner: Building Resource-specific Information Models</a><ul>
<li class="toctree-l5"><a class="reference internal" href="pfdl_namespace.html">PFDL Parameter Namespace</a></li>
<li class="toctree-l5"><a class="reference internal" href="warehouse_namespace.html">Warehouse Namespace</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beginner-build-custom-opc-ua-server">Beginner: Build custom OPC UA Server</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#beginner-writing-a-json-configuration-file">Beginner: Writing a JSON-configuration file</a></li>
<li class="toctree-l5"><a class="reference internal" href="#beginner-cmake-configuration">Beginner: CMake Configuration</a></li>
<li class="toctree-l5"><a class="reference internal" href="#beginner-build-simple-server">Beginner: Build simple server</a></li>
<li class="toctree-l5"><a class="reference internal" href="#beginner-build-the-server-executable">Beginner: Build the Server Executable</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#beginner-execute-the-pfdl-with-an-execution-engine">Beginner: Execute the PFDL with an Execution Engine</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="intermediate.html">Intermediate</a></li>
<li class="toctree-l3"><a class="reference internal" href="advanced.html">Advanced</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="how_to.html">How-To-Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="related_projects.html">Related-Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">SWAP-IT Demonstration Scenario</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="getting_started.html">Getting Started</a></li>
          <li class="breadcrumb-item"><a href="tutorial.html">Tutorials</a></li>
      <li class="breadcrumb-item active">Beginner</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/beginner.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="beginner">
<h1>Beginner<a class="headerlink" href="#beginner" title="Link to this heading"></a></h1>
<p>An easy way to start using the SWAP-IT software components is defining a simple PFDL description, which executes a single service.
For the beginner’s tutorial, a PFDL is specified that takes a part out of a warehouse. For this to be accomplished, the definition of a set of PFDL structures is required to create the Demonstration Scenario’s
SWAP_Order structure. This structure will be reused in the additional tutorials and is handed over from process step to process step, to map the parameter flow of the process.
The Demonstration Scenario’s industrial traffic light is composed of stand segments and a number of light segments, so that corresponding PFDL structures are defined to characterize
each element.</p>
<section id="beginner-writing-custom-pfdl-files">
<span id="id1"></span><h2>Beginner: Writing custom PFDL files<a class="headerlink" href="#beginner-writing-custom-pfdl-files" title="Link to this heading"></a></h2>
<p>For the beginner tutorial, the PFDL structure SWAP_Order is defined that contains all information about the traffic
light to be produced. It is the input and output variable for each process step to enable the parameter flow throughout the process.
The required PFDL is defined as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Struct</span> <span class="n">SWAP_Order</span>
    <span class="n">order_id</span><span class="p">:</span><span class="n">number</span>
    <span class="n">stand</span><span class="p">:</span><span class="n">Stand_Segment</span>
    <span class="n">segments</span><span class="p">:</span> <span class="n">Light_Segment</span><span class="p">[]</span>
    <span class="n">number_light_segments</span><span class="p">:</span> <span class="n">number</span>
<span class="n">End</span>

<span class="n">Struct</span> <span class="n">Stand_Segment</span>
    <span class="n">stand_shape</span><span class="p">:</span><span class="n">string</span>
    <span class="n">stand_height</span><span class="p">:</span><span class="n">number</span>
    <span class="n">stand_id</span><span class="p">:</span><span class="n">string</span>
<span class="n">End</span>

<span class="n">Struct</span> <span class="n">Light_Segment</span>
    <span class="n">color</span><span class="p">:</span> <span class="n">string</span>
    <span class="n">diameter</span><span class="p">:</span> <span class="n">number</span>
    <span class="n">segment_id</span><span class="p">:</span><span class="n">string</span>
<span class="n">End</span>


<span class="c1">#structure to statically assign the service to a resource</span>
<span class="c1">#this structure is only uses by the execution engine internally,</span>
<span class="c1">#so it does not have to be defined</span>
<span class="c1">#within the OPC UA namespace for the warehouse server</span>
<span class="n">Struct</span> <span class="n">ResourceAssignment</span>
    <span class="n">job_resource</span><span class="p">:</span><span class="n">string</span>
<span class="n">End</span>

<span class="c1">#production Task the defines the overall process</span>
<span class="n">Task</span> <span class="n">productionTask</span>
    <span class="c1">#define a single service GetPartsFromWarehouse</span>
    <span class="n">GetPartsFromWarehouse</span>
        <span class="n">In</span>
            <span class="n">ResourceAssignment</span>
            <span class="p">{</span>
                <span class="s2">&quot;job_resource&quot;</span><span class="p">:</span><span class="s2">&quot;opc.tcp://host.docker.internal:4840&quot;</span>
            <span class="p">}</span>
            <span class="n">SWAP_Order</span>
            <span class="p">{</span>
                <span class="s2">&quot;order_id&quot;</span><span class="p">:</span><span class="mi">1000</span><span class="p">,</span>
                <span class="s2">&quot;stand&quot;</span><span class="p">:{</span>
                      <span class="s2">&quot;stand_shape&quot;</span><span class="p">:</span><span class="s2">&quot;plate&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;stand_height&quot;</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span>
                      <span class="s2">&quot;stand_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Default&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;segments&quot;</span><span class="p">:</span>
                <span class="p">[</span>
                <span class="p">{</span>
                      <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;diameter&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="s2">&quot;segment_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Default&quot;</span>
                <span class="p">},</span>
                <span class="p">{</span>
                      <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;diameter&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                      <span class="s2">&quot;segment_id&quot;</span><span class="p">:</span> <span class="s2">&quot;Default&quot;</span>
                <span class="p">}</span>
                <span class="p">],</span>
                      <span class="s2">&quot;number_light_segments&quot;</span><span class="p">:</span> <span class="mi">1</span>
                <span class="p">}</span>

        <span class="n">Out</span>
            <span class="n">order</span><span class="p">:</span><span class="n">SWAP_Order</span>
<span class="n">End</span>
</pre></div>
</div>
<p>The visual representation of the resulting process is illustrated below:</p>
<figure class="align-default">
<a class="reference internal image-reference" href="_images/beginner.PNG"><img alt="Process Visualization Beginner" src="_images/beginner.PNG" style="width: 100%;" /></a>
</figure>
</section>
<section id="beginner-building-resource-specific-information-models">
<span id="id2"></span><h2>Beginner: Building Resource-specific Information Models<a class="headerlink" href="#beginner-building-resource-specific-information-models" title="Link to this heading"></a></h2>
<p>The pre-build Nodeset2.xml files for each namespace in this tutorial can be found within the directory <a class="reference external" href="https://github.com/swap-it/demo-scenario/tree/main/Tutorials/beginner/model">InformationModels</a>.
However, if it is  planned to use the pre-build files, this section can be skipped and the tutorial continues with section <a class="reference internal" href="#beginner-build-custom-opc-ua-server">Beginner: Build custom OPC UA Server</a>, however the following sections give a short introduction on how to
define <a href="#id3"><span class="problematic" id="id4">*</span></a>.ModelDesign.xml files, which can then be processed with the <a class="reference external" href="https://github.com/OPCFoundation/UA-ModelCompiler">UA-ModelCompiler</a> to generate NodeSet2.xml files.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="pfdl_namespace.html">PFDL Parameter Namespace</a></li>
<li class="toctree-l1"><a class="reference internal" href="warehouse_namespace.html">Warehouse Namespace</a></li>
</ul>
</div>
</section>
<section id="beginner-build-custom-opc-ua-server">
<h2>Beginner: Build custom OPC UA Server<a class="headerlink" href="#beginner-build-custom-opc-ua-server" title="Link to this heading"></a></h2>
<p>The following sections will provide a step-by-step example on how to start an OPC UA server that can interact with the SWAP-IT software modules.</p>
<section id="beginner-writing-a-json-configuration-file">
<h3>Beginner: Writing a JSON-configuration file<a class="headerlink" href="#beginner-writing-a-json-configuration-file" title="Link to this heading"></a></h3>
<p>To use the open62541 server template, it is required to provide a JSON-based server configuration. A minimal
version of such a JSON configuration for the warehouse server is shown below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nl">application_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warehouse&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">resource_ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;localhost&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">port</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4840&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">module_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;WarehouseModuleType&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">module_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;WarehouseModule&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nl">service_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GetPartsFromWarehouse&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="beginner-cmake-configuration">
<h3>Beginner: CMake Configuration<a class="headerlink" href="#beginner-cmake-configuration" title="Link to this heading"></a></h3>
<p>To load the previously defined OPC UA namespaces into open62541 based OPC UA server, it is required to
configure the CMakeLists.txt file. From this CMake configuration the <a class="reference external" href="https://www.open62541.org/doc/master/nodeset_compiler.html">open62541 nodeset compiler</a> will generate executable C-code.</p>
<p>An example of such a CMakeLists.txt file is illustrated below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">cmake_minimum_required</span><span class="p">(</span><span class="n">VERSION</span><span class="w"> </span><span class="mf">3.0.0</span><span class="p">)</span>
<span class="cp">#set name of the CMakeProject</span>
<span class="n">project</span><span class="p">(</span><span class="n">beginner_tutorial</span><span class="p">)</span>
<span class="n">find_package</span><span class="p">(</span><span class="n">open62541</span><span class="w"> </span><span class="mf">1.3</span><span class="w"> </span><span class="n">REQUIRED</span><span class="p">)</span>
<span class="k">if</span><span class="p">(</span><span class="n">NOT</span><span class="w"> </span><span class="n">CMAKE_PROJECT_NAME</span><span class="w"> </span><span class="n">STREQUAL</span><span class="w"> </span><span class="n">PROJECT_NAME</span><span class="p">)</span>
<span class="w">    </span><span class="cp"># needed or cmake doesn&#39;t recognize dependencies of generated files</span>
<span class="w">    </span><span class="n">set</span><span class="p">(</span><span class="n">PROJECT_BINARY_DIR</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">CMAKE_BINARY_DIR</span><span class="p">})</span>
<span class="n">endif</span><span class="p">()</span>
<span class="cp">#define the path to the directory in which the</span>
<span class="n">set</span><span class="p">(</span><span class="n">PATH_TO_INFORMATION_MODELS</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">PROJECT_SOURCE_DIR</span><span class="p">}</span><span class="o">/</span><span class="n">model</span><span class="p">)</span>
<span class="cp">#set output directory</span>
<span class="n">set</span><span class="p">(</span><span class="n">GENERATE_OUTPUT_DIR</span><span class="w"> </span><span class="s">&quot;${CMAKE_BINARY_DIR}/src_generated/&quot;</span><span class="p">)</span>
<span class="n">include_directories</span><span class="p">(</span><span class="s">&quot;${GENERATE_OUTPUT_DIR}&quot;</span><span class="p">)</span>
<span class="cp">#generate c code from the common model</span>
<span class="n">ua_generate_nodeset_and_datatypes</span><span class="p">(</span>
<span class="w">        </span><span class="n">NAME</span><span class="w"> </span><span class="s">&quot;common&quot;</span>
<span class="w">        </span><span class="n">FILE_BSD</span><span class="w"> </span><span class="s">&quot;${PATH_TO_INFORMATION_MODELS}/SWAP.Fraunhofer.Common.Model.Types.bsd&quot;</span>
<span class="w">        </span><span class="n">FILE_CSV</span><span class="w"> </span><span class="s">&quot;${PATH_TO_INFORMATION_MODELS}/CommonModelDesign.csv&quot;</span>
<span class="w">        </span><span class="n">FILE_NS</span><span class="w"> </span><span class="s">&quot;${PATH_TO_INFORMATION_MODELS}/SWAP.Fraunhofer.Common.Model.NodeSet2.xml&quot;</span>
<span class="w">        </span><span class="n">NAMESPACE_MAP</span><span class="w"> </span><span class="s">&quot;2:http://common.swap.fraunhofer.de&quot;</span>
<span class="w">        </span><span class="n">OUTPUT_DIR</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">GENERATE_OUTPUT_DIR</span><span class="p">}</span>
<span class="w">        </span><span class="n">INTERNAL</span>
<span class="p">)</span>
<span class="cp">#generate c code from the pfdl types model</span>
<span class="n">ua_generate_nodeset_and_datatypes</span><span class="p">(</span>
<span class="w">        </span><span class="n">NAME</span><span class="w"> </span><span class="s">&quot;pfdl_parameter&quot;</span>
<span class="w">        </span><span class="n">FILE_BSD</span><span class="w"> </span><span class="s">&quot;${PATH_TO_INFORMATION_MODELS}/SWAP.Fraunhofer.Demo.Scenario.Model.Types.bsd&quot;</span>
<span class="w">        </span><span class="n">FILE_CSV</span><span class="w"> </span><span class="s">&quot;${PATH_TO_INFORMATION_MODELS}/DemoScenarioTypes.ModelDesign.csv&quot;</span>
<span class="w">        </span><span class="n">FILE_NS</span><span class="w"> </span><span class="s">&quot;${PATH_TO_INFORMATION_MODELS}/SWAP.Fraunhofer.Demo.Scenario.Model.NodeSet2.xml&quot;</span>
<span class="w">        </span><span class="n">NAMESPACE_MAP</span><span class="w"> </span><span class="s">&quot;3:http://swap.demo.scenario.fraunhofer.de&quot;</span>
<span class="w">        </span><span class="n">OUTPUT_DIR</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">GENERATE_OUTPUT_DIR</span><span class="p">}</span>
<span class="w">        </span><span class="n">INTERNAL</span>
<span class="p">)</span>
<span class="cp">#generate c code from the warehouse model and set the dependencies to the common and pfdl types models</span>
<span class="n">ua_generate_nodeset_and_datatypes</span><span class="p">(</span>
<span class="w">        </span><span class="n">NAME</span><span class="w"> </span><span class="s">&quot;warehouse&quot;</span>
<span class="w">        </span><span class="n">DEPENDS</span><span class="w"> </span><span class="s">&quot;common&quot;</span>
<span class="w">        </span><span class="n">DEPENDS</span><span class="w"> </span><span class="s">&quot;pfdl_parameter&quot;</span>
<span class="w">        </span><span class="n">FILE_BSD</span><span class="w"> </span><span class="s">&quot;${PATH_TO_INFORMATION_MODELS}/SWAP.Fraunhofer.Demo.Scenario.Warehouse.Model.Types.bsd&quot;</span>
<span class="w">        </span><span class="n">FILE_CSV</span><span class="w"> </span><span class="s">&quot;${PATH_TO_INFORMATION_MODELS}/DemoScenarioWarehouse.ModelDesign.csv&quot;</span>
<span class="w">        </span><span class="n">FILE_NS</span><span class="w"> </span><span class="s">&quot;${PATH_TO_INFORMATION_MODELS}/SWAP.Fraunhofer.Demo.Scenario.Warehouse.Model.NodeSet2.xml&quot;</span>
<span class="w">        </span><span class="n">IMPORT_BSD</span><span class="w"> </span><span class="s">&quot;TYPES_COMMON#${PATH_TO_INFORMATION_MODELS}/SWAP.Fraunhofer.Common.Model.Types.bsd&quot;</span>
<span class="w">        </span><span class="n">IMPORT_BSD</span><span class="w"> </span><span class="s">&quot;TYPES_PFDL_PARAMETER#${PATH_TO_INFORMATION_MODELS}/SWAP.Fraunhofer.Demo.Scenario.Model.Types.bsd&quot;</span>
<span class="w">        </span><span class="n">NAMESPACE_MAP</span><span class="w"> </span><span class="s">&quot;4:http://swap.demo.scenario.warehouse.fraunhofer.de&quot;</span>
<span class="w">        </span><span class="n">OUTPUT_DIR</span><span class="w"> </span><span class="n">$</span><span class="p">{</span><span class="n">GENERATE_OUTPUT_DIR</span><span class="p">}</span>
<span class="w">        </span><span class="n">INTERNAL</span>
<span class="p">)</span>
<span class="cp">#adds the executable target</span>
<span class="n">add_executable</span><span class="p">(</span><span class="n">beginner_tutorial</span>
<span class="w">        </span><span class="n">beginner</span><span class="p">.</span><span class="n">c</span>
<span class="w">        </span><span class="n">$</span><span class="p">{</span><span class="n">UA_NODESET_PFDL_PARAMETER_SOURCES</span><span class="p">}</span>
<span class="w">        </span><span class="n">$</span><span class="p">{</span><span class="n">UA_TYPES_PFDL_PARAMETER_SOURCES</span><span class="p">}</span>
<span class="w">        </span><span class="n">$</span><span class="p">{</span><span class="n">UA_NODESET_COMMON_SOURCES</span><span class="p">}</span>
<span class="w">        </span><span class="n">$</span><span class="p">{</span><span class="n">UA_TYPES_COMMON_SOURCES</span><span class="p">}</span>
<span class="w">        </span><span class="n">$</span><span class="p">{</span><span class="n">UA_NODESET_WAREHOUSE_SOURCES</span><span class="p">}</span>
<span class="w">        </span><span class="n">$</span><span class="p">{</span><span class="n">UA_TYPES_WAREHOUSE_SOURCES</span><span class="p">}</span>
<span class="p">)</span>
<span class="cp">#add the dependencies between the beginner tutorial and the generated namespaces</span>
<span class="n">add_dependencies</span><span class="p">(</span><span class="n">beginner_tutorial</span><span class="w"> </span><span class="n">open62541</span><span class="o">-</span><span class="n">generator</span><span class="o">-</span><span class="n">ns</span><span class="o">-</span><span class="n">common</span>
<span class="w">        </span><span class="n">open62541</span><span class="o">-</span><span class="n">generator</span><span class="o">-</span><span class="n">ns</span><span class="o">-</span><span class="n">pfdl_parameter</span>
<span class="w">        </span><span class="n">open62541</span><span class="o">-</span><span class="n">generator</span><span class="o">-</span><span class="n">ns</span><span class="o">-</span><span class="n">warehouse</span>
<span class="p">)</span>
<span class="cp">#link the beginner tutorial project with the installed open62541 server template</span>
<span class="n">target_link_libraries</span><span class="p">(</span><span class="n">beginner_tutorial</span><span class="w"> </span><span class="n">swap_server_template</span><span class="p">)</span>
<span class="cp">#link the beginner tutorial project with the installed open62541 SDK</span>
<span class="n">target_link_libraries</span><span class="p">(</span><span class="n">beginner_tutorial</span><span class="w"> </span><span class="n">open62541</span><span class="o">::</span><span class="n">open62541</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="beginner-build-simple-server">
<h3>Beginner: Build simple server<a class="headerlink" href="#beginner-build-simple-server" title="Link to this heading"></a></h3>
<p>To build the first OPC UA server that is compatible with the SWAP-IT software, the open62541 server template is used.
This template builds the internal server structure
that is required by the process agent. In addition, it is required to define a custom method callback for the GetPartsFromWarehouse service:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;signal.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;open62541/plugin/log_stdout.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;open62541/server.h&gt;</span>
<span class="cm">/*include the open62541 server template library*/</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;swap_it.h&quot;</span>
<span class="cm">/*include the generated c code from the nodeset compiler*/</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;namespace_common_generated.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;namespace_pfdl_parameter_generated.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;namespace_warehouse_generated.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;types_common_generated.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;types_pfdl_parameter_generated_handling.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;types_common_generated_handling.h&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;warehouse_nodeids.h&quot;</span>

<span class="n">UA_StatusCode</span><span class="w"> </span><span class="nf">warehousemethodCallback</span><span class="p">(</span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="p">,</span>
<span class="w">                                  </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">sessionId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">sessionHandle</span><span class="p">,</span>
<span class="w">                                  </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">methodId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">methodContext</span><span class="p">,</span>
<span class="w">                                  </span><span class="k">const</span><span class="w"> </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="o">*</span><span class="n">objectId</span><span class="p">,</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">objectContext</span><span class="p">,</span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">inputSize</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">input</span><span class="p">,</span>
<span class="w">                                  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">outputSize</span><span class="p">,</span><span class="w"> </span><span class="n">UA_Variant</span><span class="w"> </span><span class="o">*</span><span class="n">output</span><span class="p">){</span>

<span class="w">    </span><span class="c1">//set output variable for the Service finished event</span>
<span class="w">    </span><span class="n">UA_SWAP_Order</span><span class="w"> </span><span class="n">order</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_SWAP_Order_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">order</span><span class="p">);</span>
<span class="w">    </span><span class="n">order</span><span class="p">.</span><span class="n">number_light_segments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="n">order</span><span class="p">.</span><span class="n">order_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">;</span>
<span class="w">    </span><span class="n">order</span><span class="p">.</span><span class="n">segmentsSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="w">    </span><span class="n">UA_Light_Segment</span><span class="w"> </span><span class="o">*</span><span class="n">segments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UA_Light_Segment</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">UA_calloc</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">UA_Light_Segment</span><span class="p">));</span>
<span class="w">    </span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">diameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_String_fromChars</span><span class="p">(</span><span class="s">&quot;red&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">segments</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">segment_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_String_fromChars</span><span class="p">(</span><span class="s">&quot;Default&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">segments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">diameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="n">segments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_String_fromChars</span><span class="p">(</span><span class="s">&quot;green&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">segments</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">segment_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_String_fromChars</span><span class="p">(</span><span class="s">&quot;Default&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_Stand_Segment</span><span class="w"> </span><span class="n">stand</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Stand_Segment_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">stand</span><span class="p">);</span>
<span class="w">    </span><span class="n">stand</span><span class="p">.</span><span class="n">stand_height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">stand</span><span class="p">.</span><span class="n">stand_shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_String_fromChars</span><span class="p">(</span><span class="s">&quot;plate&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">stand</span><span class="p">.</span><span class="n">stand_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_String_fromChars</span><span class="p">(</span><span class="s">&quot;Default&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="n">order</span><span class="p">.</span><span class="n">stand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stand</span><span class="p">;</span>
<span class="w">    </span><span class="n">order</span><span class="p">.</span><span class="n">segments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">segments</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//print the specified parameter</span>
<span class="w">    </span><span class="n">UA_String</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_STRING_NULL</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_print</span><span class="p">(</span><span class="o">&amp;</span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES_PFDL_PARAMETER</span><span class="p">[</span><span class="n">UA_TYPES_PFDL_PARAMETER_SWAP_ORDER</span><span class="p">],</span><span class="w"> </span><span class="o">&amp;</span><span class="n">out</span><span class="p">);</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Order Variable: %.*s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">out</span><span class="p">.</span><span class="n">length</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">.</span><span class="n">data</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_String_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">out</span><span class="p">);</span>

<span class="w">    </span><span class="n">UA_Variant</span><span class="w"> </span><span class="n">temp</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_Variant_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">temp</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Variant_setScalarCopy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES_PFDL_PARAMETER</span><span class="p">[</span><span class="n">UA_TYPES_PFDL_PARAMETER_SWAP_ORDER</span><span class="p">]);</span>
<span class="w">    </span><span class="c1">//fire the service result event</span>
<span class="w">    </span><span class="n">UA_NodeId</span><span class="w"> </span><span class="n">eventOutNodeId</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_NodeId_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">eventOutNodeId</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_createEvent</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">UA_WAREHOUSEID_GETPARTSFROMWAREHOUSE</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">eventOutNodeId</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_writeObjectProperty_scalar</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">eventOutNodeId</span><span class="p">,</span>
<span class="w">                                         </span><span class="n">UA_QUALIFIEDNAME</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;order&quot;</span><span class="p">),</span><span class="w"> </span><span class="o">&amp;</span><span class="n">order</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES_PFDL_PARAMETER</span><span class="p">[</span><span class="n">UA_TYPES_PFDL_PARAMETER_SWAP_ORDER</span><span class="p">]);</span>

<span class="w">    </span><span class="n">UA_LOG_INFO</span><span class="p">(</span><span class="n">UA_Log_Stdout</span><span class="p">,</span><span class="w"> </span><span class="n">UA_LOGCATEGORY_USERLAND</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Trigger the event&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_triggerEvent</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">eventOutNodeId</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NODEID_NUMERIC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">UA_NS0ID_SERVER</span><span class="p">),</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">UA_TRUE</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_NodeId_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">eventOutNodeId</span><span class="p">);</span>

<span class="w">    </span><span class="c1">//create the ServiceExecutionAsyncResultDataType variable</span>
<span class="w">    </span><span class="n">UA_ServiceExecutionAsyncResultDataType</span><span class="w"> </span><span class="n">res</span><span class="p">;</span>
<span class="w">    </span><span class="n">UA_ServiceExecutionAsyncResultDataType_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">res</span><span class="p">);</span>
<span class="w">    </span><span class="n">res</span><span class="p">.</span><span class="n">serviceResultCode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UA_UInt32</span><span class="p">)</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">res</span><span class="p">.</span><span class="n">serviceResultMessage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_String_fromChars</span><span class="p">(</span><span class="s">&quot;Message&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">res</span><span class="p">.</span><span class="n">expectedServiceExecutionDuration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UA_Double</span><span class="p">)</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
<span class="w">    </span><span class="n">res</span><span class="p">.</span><span class="n">serviceTriggerResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_SERVICETRIGGERRESULT_SERVICE_RESULT_ACCEPTED</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//set the variable as method output</span>
<span class="w">    </span><span class="n">UA_Variant_setScalarCopy</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">UA_TYPES_COMMON</span><span class="p">[</span><span class="n">UA_TYPES_COMMON_SERVICEEXECUTIONASYNCRESULTDATATYPE</span><span class="p">]);</span>
<span class="w">    </span><span class="n">UA_String_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">res</span><span class="p">.</span><span class="n">serviceResultMessage</span><span class="p">);</span>
<span class="w">    </span><span class="c1">//free allocated memory</span>
<span class="w">    </span><span class="n">free</span><span class="p">(</span><span class="n">order</span><span class="p">.</span><span class="n">segments</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">UA_STATUSCODE_GOOD</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally, it is possible to write the main function of the server, where the three information models, the common information model, the pfdl parameter model and the warehouse model are loaded. Besides the JSON configuration is provided, so that the
server can be instantiated with the open62541 swap server template’s function UA_server_swap_it:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">UA_Boolean</span><span class="w"> </span><span class="n">running</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">stopHandler</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sign</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">UA_LOG_INFO</span><span class="p">(</span><span class="n">UA_Log_Stdout</span><span class="p">,</span><span class="w"> </span><span class="n">UA_LOGCATEGORY_SERVER</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;received ctrl-c&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="n">running</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">signal</span><span class="p">(</span><span class="n">SIGINT</span><span class="p">,</span><span class="w"> </span><span class="n">stopHandler</span><span class="p">);</span>
<span class="w">    </span><span class="n">signal</span><span class="p">(</span><span class="n">SIGTERM</span><span class="p">,</span><span class="w"> </span><span class="n">stopHandler</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/* create the server structure*/</span>
<span class="w">    </span><span class="n">UA_Server</span><span class="w"> </span><span class="o">*</span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_Server_new</span><span class="p">();</span>
<span class="w">    </span><span class="cm">/* load the required namespace with autogenerated functions from the nodeset-compiler*/</span>
<span class="w">    </span><span class="n">UA_StatusCode</span><span class="w"> </span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">namespace_common_generated</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">retval</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">UA_STATUSCODE_GOOD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">UA_LOG_WARNING</span><span class="p">(</span><span class="n">UA_Log_Stdout</span><span class="p">,</span><span class="w"> </span><span class="n">UA_LOGCATEGORY_SERVER</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Adding the common namespace failed. Please check previous error output.&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">UA_Server_delete</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">namespace_pfdl_parameter_generated</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">retval</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">UA_STATUSCODE_GOOD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">UA_LOG_ERROR</span><span class="p">(</span><span class="n">UA_Log_Stdout</span><span class="p">,</span><span class="w"> </span><span class="n">UA_LOGCATEGORY_SERVER</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Adding the pfdl types namespace failed. Please check previous error output.&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">UA_Server_delete</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">retval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">namespace_warehouse_generated</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">retval</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">UA_STATUSCODE_GOOD</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">UA_LOG_ERROR</span><span class="p">(</span><span class="n">UA_Log_Stdout</span><span class="p">,</span><span class="w"> </span><span class="n">UA_LOGCATEGORY_SERVER</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Adding the pfdl types namespace failed. Please check previous error output.&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">UA_Server_delete</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="cm">/*store the JSON config in a UA_ByteString to hand it over to the UA_server_swap_it function*/</span>
<span class="w">    </span><span class="n">UA_ByteString</span><span class="w"> </span><span class="n">conf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UA_String_fromChars</span><span class="p">(</span><span class="s">&quot;{</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">                                             </span><span class="s">&quot;  application_name: </span><span class="se">\&quot;</span><span class="s">warehouse_dr1</span><span class="se">\&quot;</span><span class="s">,</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">                                             </span><span class="s">&quot;  resource_ip: </span><span class="se">\&quot;</span><span class="s">localhost</span><span class="se">\&quot;</span><span class="s">,</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">                                             </span><span class="s">&quot;  port: </span><span class="se">\&quot;</span><span class="s">4840</span><span class="se">\&quot;</span><span class="s">,</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">                                             </span><span class="s">&quot;  module_type: </span><span class="se">\&quot;</span><span class="s">WarehouseModuleType</span><span class="se">\&quot;</span><span class="s">,</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">                                             </span><span class="s">&quot;  module_name: </span><span class="se">\&quot;</span><span class="s">WarehouseModule</span><span class="se">\&quot;</span><span class="s">,</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">                                             </span><span class="s">&quot;  service_name: </span><span class="se">\&quot;</span><span class="s">GetPartsFromWarehouse</span><span class="se">\&quot;</span><span class="s">,</span><span class="se">\n</span><span class="s">&quot;</span>
<span class="w">                                             </span><span class="s">&quot;}&quot;</span><span class="p">);</span><span class="w"> </span><span class="cm">/*loadFile(path_to_config);*/</span>
<span class="w">    </span><span class="cm">/* the structure UA_service_server_interpreter will return the pre-defined information about the server</span>
<span class="cm">     * from the json configration*/</span>
<span class="w">    </span><span class="n">UA_service_server_interpreter</span><span class="w"> </span><span class="n">swap_server</span><span class="p">;</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">swap_server</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">UA_service_server_interpreter</span><span class="p">));</span>
<span class="w">    </span><span class="cm">/* with the function UA_server_swap_it from the open62541 server template,</span>
<span class="cm">     * it is possible to configure the OPC UA server with a single function call*/</span>
<span class="w">    </span><span class="n">UA_server_swap_it</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">conf</span><span class="p">,</span><span class="w"> </span><span class="n">warehousemethodCallback</span><span class="p">,</span><span class="w"> </span><span class="n">UA_FALSE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">running</span><span class="p">,</span><span class="w"> </span><span class="n">UA_FALSE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">swap_server</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_ByteString_clear</span><span class="p">(</span><span class="o">&amp;</span><span class="n">conf</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/*start and run the server*/</span>
<span class="w">    </span><span class="n">UA_Server_run_startup</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="n">running</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">UA_Server_run_iterate</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="nb">true</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//clear memory</span>
<span class="w">    </span><span class="n">clear_swap_server</span><span class="p">(</span><span class="o">&amp;</span><span class="n">swap_server</span><span class="p">,</span><span class="w"> </span><span class="n">UA_FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_LOG_INFO</span><span class="p">(</span><span class="n">UA_Log_Stdout</span><span class="p">,</span><span class="w"> </span><span class="n">UA_LOGCATEGORY_SERVER</span><span class="p">,</span><span class="s">&quot;Shutting down server %s &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">swap_server</span><span class="p">.</span><span class="n">server_name</span><span class="p">);</span>
<span class="w">    </span><span class="cm">/*Shut down the server*/</span>
<span class="w">    </span><span class="n">UA_Server_run_shutdown</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="w">    </span><span class="n">UA_Server_delete</span><span class="p">(</span><span class="n">server</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="beginner-build-the-server-executable">
<h3>Beginner: Build the Server Executable<a class="headerlink" href="#beginner-build-the-server-executable" title="Link to this heading"></a></h3>
<p>After the code is completed, it is now possible to compile the server executable. For this to be achieved, create a build directory within the working directory and compile the server with the cmake and make command.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span><span class="w"> </span><span class="n">working</span><span class="w"> </span><span class="n">directory</span>
<span class="n">mkdir</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">build</span>
<span class="n">cmake</span><span class="w"> </span><span class="p">..</span>
<span class="n">make</span>
<span class="cm">/*start the executable*/</span>
<span class="p">.</span><span class="o">/</span><span class="n">beginner_tutorial</span>
</pre></div>
</div>
<p>In case that the shop floor should be started from the tutorial implementation, execute the following steps:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//github.com/swap-it/demo-scenario.git</span>
<span class="n">cd</span><span class="w"> </span><span class="n">demo</span><span class="o">-</span><span class="n">scenario</span><span class="o">/</span><span class="n">Tutorials</span><span class="o">/</span><span class="n">beginner</span>
<span class="n">mkdir</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">build</span>
<span class="n">cmake</span><span class="w"> </span><span class="p">..</span>
<span class="n">make</span>
<span class="cm">/*start the executable*/</span>
<span class="p">.</span><span class="o">/</span><span class="n">beginner_tutorial</span>
</pre></div>
</div>
</section>
</section>
<section id="beginner-execute-the-pfdl-with-an-execution-engine">
<h2>Beginner: Execute the PFDL with an Execution Engine<a class="headerlink" href="#beginner-execute-the-pfdl-with-an-execution-engine" title="Link to this heading"></a></h2>
<p>Since the code basis of the process agent in not available yet, we provide a docker compose file which starts the missing application, in fact the process agent and the dashboard, in a docker compose project. A corresponding
Docker-compose.yaml file is provided in the <a class="reference external" href="https://github.com/swap-it/demo-scenario/tree/main/Tutorials/beginner">beginner directory</a>.
This docker application can be started with the following steps, so that the beginner tutorial PFDL and the corresponding process is executed on the resource, which is implemented in this tutorial:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//github.com/swap-it/demo-scenario.git</span>
<span class="n">cd</span><span class="w"> </span><span class="n">demo</span><span class="o">-</span><span class="n">scenario</span><span class="o">/</span><span class="n">Tutorials</span><span class="o">/</span><span class="n">beginner</span>
<span class="n">docker</span><span class="o">-</span><span class="n">compose</span><span class="w"> </span><span class="n">up</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="intermediate.html" class="btn btn-neutral float-right" title="Intermediate" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2024, Fraunhofer IOSB.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>